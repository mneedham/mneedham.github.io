
<!DOCTYPE html>
<html lang="en-us">

    <head>

        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" QuickGraph #4: UK Official Singles Chart 2019 &middot;  Mark Needham" />
        <meta property="og:site_name" content="Mark Needham" />
        <meta property="og:url" content="https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/" />

    
        <meta property="og:type" content="article" />
        <meta property="og:article:published_time" content="2020-01-04T00:21:00Z" />
        <meta property="og:article:tag" content="quickgraph" />
        <meta property="og:article:tag" content="neo4j" />
        <meta property="og:article:tag" content="apoc" />
        

        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@markhneedham" />
        <meta name="twitter:creator" content="@markhneedham" />
        <meta name="twitter:title" content="QuickGraph #4: UK Official Singles Chart 2019" />
        
          <meta name="twitter:description" content="Learn how to build a graph of the UK&#39;s Official Singles Chart" />
        
        <meta name="twitter:url" content="https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/" />

      
        
        <meta name="og:image" content="https://markhneedham.com/blog//uploads/2020/01/official-charts-header.png" />
        <meta name="twitter:image:src" content="https://markhneedham.com/blog//uploads/2020/01/official-charts-header.png" />
        <meta name="twitter:image" content="https://markhneedham.com/blog//uploads/2020/01/official-charts-header.png" />
      

    

        <title> QuickGraph #4: UK Official Singles Chart 2019 &middot;  Mark Needham</title>

    
        <meta name="description" content="Learn how to build a graph of the UK&#39;s Official Singles Chart" />
    

        <meta name="p:domain_verify" content="fc173d84e3a4de948ed4bda2908afd3e"/>
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        
        

    
        <link href="https://markhneedham.com/blog/index.xml" rel="alternate" type="application/rss+xml" title="Mark Needham" />
    

    
        <link rel="canonical" href="https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/" />

    
    <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "QuickGraph #4: UK Official Singles Chart 2019",
        "author": {
            "@type": "Person",
            "name": "http://profiles.google.com/100354797468725665406?rel=author"
        },
        "datePublished": "2020-01-04",
        "description": "For our first QuickGraph of the new decade we\x26#8217;re going to explore data from the Official UK Top 40 Chart. This chart ranks the top 100 songs of the week based on official sales of sales of downloads, CD, vinyl, audio streams and video streams. Every week BBC Radio 1 broadcast the top 40 songs, which explains the name of the chart.\n  Figure 1. The Official UK Charts  Scraping the Official Charts I couldn\x26#8217;t find a dump of the dataset, so we\x26#8217;re going to use our web scraping skills again.",
        "wordCount":  2494 
    }
    </script>
    

    

<style>
*{padding:0;margin:0}body,html{font-size:1em;line-height:1.65em;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;font-weight:300;color:#444}html{height:100%}body{padding:2em 2.5em 1em 20em}header{border-right:1px #eee solid;padding:2em;position:fixed;top:0;left:0;height:100%;width:13.5em}#content{display:block;width:100%}footer{padding:1em 0 2.5em;font-size:.8em;line-height:1.5em;color:#888}article{border-bottom:.1em #eee solid;padding-bottom:1.7em;max-width:56em}h4,h5,h6,hr,p{margin-top:.9em;margin-bottom:.9em}h1,h2,h3,h4,h5,h6{font-family:"Bree Serif",serif;font-weight:400!important}h1{font-size:2.5em;line-height:1.1em;margin-top:.6em;margin-bottom:.6em}h2{font-size:1.9em;line-height:1.2em;margin-top:.7em;margin-bottom:.7em}h3{font-size:1.4em;line-height:1.3em;margin-top:.8em;margin-bottom:.8em}h4{font-size:1.3em}h5{font-size:1.2em}h6{font-size:1.1em}iframe,img{max-width:100%}a{font-weight:700;text-decoration:none;color:#5cc265}a:hover{text-decoration:underline}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{font-weight:400!important}strong{font-weight:700}blockquote{border-left:.4em solid #eee;padding-left:1.2em;font-size:1.3em}hr{border:0;height:1px;background:#eee}ol,ul{margin-left:3em}code{font-size:1.4em;background:#eee}pre{font-size:.8em;line-height:2em;background:#eee;padding:1em;word-break:break-all;word-wrap:break-word;white-space:pre;white-space:-moz-pre-wrap;white-space:pre-wrap}input{font-size:1em;padding:.3em}header h1{font-size:1.9em;margin-top:.8em;margin-bottom:.6em}header h1 a{color:#444}header h1 a:hover{text-decoration:none}header #logo img{width:9em;height:9em;border-radius:4.5em;-moz-border-radius:4.5em;-webkit-border-radius:4.5em;border:none}#follow-icons{font-size:.7em;margin-top:-.7em;margin-bottom:1.5em}#follow-icons a{color:#ccc}#follow-icons span{vertical-align:top;margin-left:-.15em;margin-right:-.15em}#follow-icons span .fa-stack-1x{font-size:1.05em;line-height:1.9em}header h6{margin-top:.5em}article span.post-stamp{color:#888}h1.post-title{margin-top:.35em;margin-bottom:.6em}h3.post-title{margin-top:.4em;padding-bottom:.9em;border-bottom:1px solid #eee;font-size:1.2em;color:#444}.post-title .feature-star{font-size:.9em}.feature-star,.separator,.taglist{color:#ccc}.taglist a{background-color:#ccc;color:#fff;display:inline-block;line-height:1.5em;padding:.3em .6em;vertical-align:20%;font-size:.5em;font-family:"Open Sans",sans-serif;font-weight:700!important;text-transform:uppercase;letter-spacing:.05em;border-radius:.25em;-moz-border-radius:.25em;-webkit-border-radius:.25em}#social-bar{margin-top:1.5em;background-color:#eee;padding:.5em}#comments{margin-top:.15em;padding-bottom:.2em;border-bottom:1px solid #eee}.pagination{margin-bottom:1em}footer a{font-weight:300;color:#888;text-decoration:underline}footer a:hover{color:#444;text-decoration:none}@media only screen and (min-width:1281px){body,html{font-size:1.1em}}@media only screen and (max-width:800px){body{padding:0}header{border-right:none;border-bottom:1px #eee solid;position:relative;height:auto;width:auto;text-align:center;padding-bottom:1em}#content{margin-left:0;padding:2em 2em 1em;width:auto}footer{padding:0 2.5em 2em}}@media only screen and (max-width:320px){#content,header{padding:1.2em 1.2em .6em}footer{padding:0 1.5em 1.2em}ol,ul{margin-left:2em}}
</style>

<style>
.stretch{width:100%}
table{border-collapse:collapse;border-spacing:0}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8);}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6;}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0; margin-top: 0;}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px; margin-top: 0.5em;}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
td>div.verse{white-space:pre}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock,th.tableblock{font-size:0.8em}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#008cc1;font-weight:400;margin-top:.25em;margin-bottom:.25em}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}

tbody tr pre {margin-bottom: 27px}
</style>

    </head>
    <body>
        <header id="header">
            <a id="logo" href="https://markhneedham.com/blog/"><img src="https://markhneedham.com/blog//me.jpg" alt="Mark Needham" /></a>
            <h1><a href="https://markhneedham.com/blog/">Mark Needham</a></h1>
            <p>Learn how to build a graph of the UK&#39;s Official Singles Chart</p>

            <div id="follow-icons">
	<a href="http://twitter.com/markhneedham" rel="me"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="http://linkedin.com/in/markhneedham" rel="me"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="http://github.com/mneedham" rel="me"><i class="fa fa-github-square fa-2x"></i></a>
	<a href="mailto:m.h.needham@gmail.com"><i class="fa fa-envelope-square fa-2x"></i></a>
	<a href="https://markhneedham.com/blog/index.xml" rel="me"><i class="fa fa-rss-square fa-2x"></i></a>
</div>

            

          <p>
            I co-authored the O'Reilly Graph Algorithms Book with Amy Hodler. If you like my blog posts, you might like that too. You can <strong><a href="https://neo4j.com/graph-algorithms-book/?utm_source=markhneedham.com" target="_blank">download a free copy</a></strong> for a limited time.

            <a href="https://neo4j.com/graph-algorithms-book/?utm_source=markhneedham.com" target="_blank">
              <img src="https://s3.amazonaws.com/dev.assets.neo4j.com/wp-content/uploads/20190412100510/graph-algorithms-oreilly-book-graph-analytics.png" style="padding-top: 5px;" />
            </a>

          </p>
        </header>

<main id="content">

<article id="" class="2020">
    <div class="post-stamp">
        <time datetime="2020-01-04T00:21:00Z">
            4 Jan 2020
        </time>
        <span class="taglist">
        
        &middot;
        
            <a href="https://markhneedham.com/blog/tag/quickgraph/">quickgraph</a>
        
            <a href="https://markhneedham.com/blog/tag/neo4j/">neo4j</a>
        
            <a href="https://markhneedham.com/blog/tag/apoc/">apoc</a>
        
        
        </span>
    </div>
    <h1 class="post-title">QuickGraph #4: UK Official Singles Chart 2019</h1>
    <div class="paragraph">
<p>For our first QuickGraph of the new decade we&#8217;re going to explore data from the <a href="https://www.officialcharts.com/" target="_blank" rel="noopener">Official UK Top 40 Chart</a>.
This chart ranks the top 100 songs of the week based on official sales of sales of downloads, CD, vinyl, audio streams and video streams.
Every week BBC Radio 1 broadcast the top 40 songs, which explains the name of the chart.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/official-charts-header.png" alt="official charts header">
</div>
<div class="title">Figure 1. The Official UK Charts</div>
</div>
<div class="sect1">
<h2 id="_scraping_the_official_charts">Scraping the Official Charts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I couldn&#8217;t find a dump of the dataset, so we&#8217;re going to use our web scraping skills again.
Below is a printscreen showing the page that we&#8217;re going to scrape.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/uk-charts-raw-data.png" alt="uk charts raw data">
</div>
<div class="title">Figure 2. UK Charts Raw Data</div>
</div>
<div class="paragraph">
<p>If we take a look at the underlying HTML, we&#8217;ll see that each chart entry is conveniently represented by a row in a table:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/uk-charts-one-row.png" alt="uk charts one row">
</div>
<div class="title">Figure 3. HTML of one chart entry in the UK Charts</div>
</div>
<div class="paragraph">
<p>I wrote a couple of Python scripts to <a href="https://github.com/mneedham/uk-charts-neo4j/blob/master/scripts/download_charts.py" target="_blank" rel="noopener">download each of the charts</a> and then for each chart entry, <a href="https://github.com/mneedham/uk-charts-neo4j/blob/master/scripts/scrape.py" target="_blank" rel="noopener">extract the position, track, artist, and record label</a>.
We generate one JSON document per chart entry, and below is an example of one of these documents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "start": "01 March 2019",
  "end": "07 March 2019",
  "position": 2,
  "track_name": "Giant",
  "track_uri": "/search/singles/giant/",
  "track_file_name": "search-singles-giant",
  "artist_name": "Calvin Harris &amp; Rag'N'Bone Man",
  "artist_uri": "/artist/54916/calvin-harris-and-ragnbone-man/",
  "label": "Columbia"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For many of the tracks the data scraped from the Official Charts website is sufficient, but for some of them I found it difficult to figure out the names of all the collaborating artists.
I thought this would be a good opportunity to use the Spotify API to enrich the dataset.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enriching_the_data_with_the_spotify_api">Enriching the data with the Spotify API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;ll use <a href="https://developer.spotify.com/documentation/web-api/reference-beta/#category-search" target="_blank" rel="noopener">Spotify&#8217;s Search API</a> to retrieve the names of all collaborating artists for a track.
Instructions explaining how <a href="https://github.com/mneedham/uk-charts-neo4j#downloading-and-scraping-charts" target="_blank" rel="noopener">how to download and enrich the data</a> are described in the <a href="https://github.com/mneedham/uk-charts-neo4j" target="_blank" rel="noopener">uk-charts-neo4j</a> repository.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exploring_the_data">Exploring the data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s have a quick look at the first few lines of this file using command line tools:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">head -n3 import/items.json | jq '.'</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run that command, we&#8217;ll see the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "start": "01 March 2019",
  "end": "07 March 2019",
  "position": 1,
  "track_name": "Someone You Loved",
  "track_uri": "/search/singles/someone-you-loved/",
  "track_file_name": "search-singles-someone-you-loved",
  "artist_name": "Lewis Capaldi",
  "artist_uri": "/artist/51369/lewis-capaldi/",
  "label": "Emi",
  "duration": 182160,
  "artists": [
    {
      "id": "4GNC7GD6oZMSxPGyXy4MNB",
      "name": "Lewis Capaldi"
    }
  ]
}
{
  "start": "01 March 2019",
  "end": "07 March 2019",
  "position": 2,
  "track_name": "Giant",
  "track_uri": "/search/singles/giant/",
  "track_file_name": "search-singles-giant",
  "artist_name": "Calvin Harris &amp; Rag'N'Bone Man",
  "artist_uri": "/artist/54916/calvin-harris-and-ragnbone-man/",
  "label": "Columbia",
  "duration": 229184,
  "artists": [
    {
      "id": "7CajNmpbOovFoOoasH2HaY",
      "name": "Calvin Harris"
    },
    {
      "id": "4f9iBmdUOhQWeP7dcAn1pf",
      "name": "Rag'n'Bone Man"
    }
  ]
}
{
  "start": "01 March 2019",
  "end": "07 March 2019",
  "position": 3,
  "track_name": "Break Up With Your Girlfriend I'M Bored",
  "track_uri": "/search/singles/break-up-with-your-girlfriend-i'm-bored/",
  "track_file_name": "search-singles-break-up-with-your-girlfriend-i'm-bored",
  "artist_name": "Ariana Grande",
  "artist_uri": "/artist/26221/ariana-grande/",
  "label": "Republic Records",
  "duration": 190440,
  "artists": [
    {
      "id": "66CXWjxzNUsdJxJ2JdwvnR",
      "name": "Ariana Grande"
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also use the <a href="https://neo4j.com/docs/labs/apoc/3.5/" target="_blank" rel="noopener">APOC</a> Library&#8217;s <a href="https://neo4j.com/docs/labs/apoc/current/import/load-json/" target="_blank" rel="noopener"><code>apoc.load.json</code></a> procedure to explore the data.
The following query returns the 1st chart entry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.load.json("https://github.com/mneedham/uk-charts-neo4j/raw/master/import/items.json")
YIELD value
RETURN value
LIMIT 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run that query we&#8217;ll see the following output:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Exploring the data</caption>
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">{"duration":182160,"track_file_name":"search-singles-someone-you-loved","artist_uri":"/artist/51369/lewis-capaldi/","artist_name":"Lewis Capaldi","artists":[{"name":"Lewis Capaldi","id":"4GNC7GD6oZMSxPGyXy4MNB"}],"start":"01 March 2019","end":"07 March 2019","position":1,"label":"Emi","track_uri":"/search/singles/someone-you-loved/","track_name":"Someone You Loved"}</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Next we&#8217;re going to use the <code>apoc.load.json</code> procedure to load the data into Neo4j.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_importing_the_data">Importing the data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;re going to import the data into the following graph model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/uk-chart-model.png" alt="uk chart model">
</div>
<div class="title">Figure 4. Graph Model for the UK Charts</div>
</div>
<div class="paragraph">
<p>The following statements set up indexes and constraints for our graph:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CREATE INDEX ON :Chart(start);
CREATE CONSTRAINT ON (l:Label) ASSERT l.name IS UNIQUE;
CREATE CONSTRAINT ON (s:Song) ASSERT s.uri IS UNIQUE;
CREATE CONSTRAINT ON (a:Artist) ASSERT a.id IS UNIQUE;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following statement imports the charts, songs, artists, and labels into the graph:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">CALL apoc.load.json("file://items.json")
YIELD value

MERGE (chart:Chart {
  start: date(datetime({epochmillis: apoc.date.parse(value.start, "ms", "dd MMMM yyyy")})),
  end: date(datetime({epochmillis: apoc.date.parse(value.end, "ms", "dd MMMM yyyy")}))
})
MERGE (label:Label {name: value.label})
MERGE (song:Song {uri: value.track_uri})
SET song.title = value.track_name,
    song.duration = CASE WHEN value.duration is null THEN null
                         ELSE duration({milliseconds:value.duration})
                    END

MERGE (song)-[:LABEL]-&gt;(label)
MERGE (song)-[inChart:IN_CHART]-&gt;(chart)
SET inChart.position = value.position

FOREACH(artist IN value.artists |
  MERGE (a:Artist {id: artist.id})
  SET a.name = artist.name
  MERGE (song)-[:ARTIST]-&gt;(a)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can see a sample of the imported graph in the Neo4j Browser visualisation below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/uk-chart-preview.png" alt="uk chart preview">
</div>
<div class="title">Figure 5. Sample of the UK Charts Graph</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_querying_the_graph">Querying the graph</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now let&#8217;s explore the data using Neo4j&#8217;s <a href="https://neo4j.com/developer/cypher-basics-i/" target="_blank" rel="noopener">Cypher</a> query language.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_which_song_was_number_1_for_the_most_weeks">Which song was number 1 for the most weeks?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (song:Song)-[inChart:IN_CHART {position: 1}]-&gt;(chart),
      (song)-[:ARTIST]-&gt;(artist)

// order the chart dates so that they show in order when
// we collect them in the RETURN statement
WITH song, collect(artist.name) AS artists, inChart, chart
ORDER BY chart.start

RETURN song.title AS song, artists,
       apoc.date.format(song.duration.milliseconds, 'ms', 'mm:ss') AS duration,
       count(*) AS count, collect(toString(chart.end)) AS weeks
ORDER By count DESC;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Which song was number 1 for the most weeks?</caption>
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">song</th>
<th class="tableblock halign-left valign-top">artists</th>
<th class="tableblock halign-left valign-top">duration</th>
<th class="tableblock halign-left valign-top">count</th>
<th class="tableblock halign-left valign-top">weeks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Dance Monkey"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Tones and I"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:29"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-10-10", "2019-10-17", "2019-10-24", "2019-10-31", "2019-11-07", "2019-11-14", "2019-11-21", "2019-11-28", "2019-12-05", "2019-12-12", "2019-12-19"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"I Don&#8217;T Care"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ed Sheeran", "Justin Bieber"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:39"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-05-23", "2019-05-30", "2019-06-06", "2019-06-13", "2019-06-20", "2019-06-27", "2019-07-04", "2019-07-11"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Someone You Loved"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Lewis Capaldi"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:02"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-03-07", "2019-03-14", "2019-03-21", "2019-03-28", "2019-04-04", "2019-04-11", "2019-04-18"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Senorita"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Shawn Mendes", "Camila Cabello"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:10"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-07-18", "2019-08-01", "2019-08-08", "2019-08-15", "2019-08-22", "2019-08-29"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Take Me Back To London"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ed Sheeran", "Stormzy"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:09"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-09-05", "2019-09-12", "2019-09-19", "2019-09-26", "2019-10-03"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Sweet But Psycho"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ava Max"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:07"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-01-03", "2019-01-10", "2019-01-17", "2019-01-24"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"7 Rings"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ariana Grande"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"02:58"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-01-31", "2019-02-07", "2019-02-14", "2019-02-28"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Old Town Road"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Billy Ray Cyrus", "Lil Nas X"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"02:37"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-04-25", "2019-05-02"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Vossi Bop"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Stormzy"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:16"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-05-09", "2019-05-16"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Break Up With Your Girlfriend I&#8217;M Bored"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ariana Grande"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:10"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-02-21"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Beautiful People"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Khalid", "Ed Sheeran"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:17"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-07-25"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"I Love Sausage Rolls"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["LadBaby"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"03:23"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-12-26"]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The extremely catchy Dance Monkey was number 1 for 11 weeks, or just less than 3 months of the year.
We can see Ed Sheeran show up in the <em>artists</em> column a few times as well, so let&#8217;s next see which artist was number 1 for the most weeks.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_which_artist_was_number_1_for_the_most_weeks">Which artist was number 1 for the most weeks?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (song:Song)-[inChart:IN_CHART {position: 1}]-&gt;(chart),
      (song)-[:ARTIST]-&gt;(artist:Artist)
WITH artist, song, count(*) AS weeks
RETURN artist.name,
       apoc.map.fromPairs(collect([song.title, weeks])) AS songs,
       count(*) AS count,
       sum(weeks) AS weeks
ORDER BY weeks DESC;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Which artist was number 1 for the most weeks?</caption>
<colgroup>
<col style="width: 12.5%;">
<col style="width: 62.5%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">artist</th>
<th class="tableblock halign-left valign-top">songs</th>
<th class="tableblock halign-left valign-top">count</th>
<th class="tableblock halign-left valign-top">weeks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Ed Sheeran"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Take Me Back To London</code>: 5, <code>I Don&#8217;T Care</code>: 8, <code>Beautiful People</code>: 1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Tones and I"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Dance Monkey</code>: 11}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Justin Bieber"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>I Don&#8217;T Care</code>: 8}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Lewis Capaldi"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Someone You Loved</code>: 7}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Stormzy"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Take Me Back To London</code>: 5, <code>Vossi Bop</code>: 2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Shawn Mendes"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{Senorita: 6}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Camila Cabello"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{Senorita: 6}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Ariana Grande"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>7 Rings</code>: 4, <code>Break Up With Your Girlfriend I&#8217;M Bored</code>: 1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Ava Max"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Sweet But Psycho</code>: 4}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Billy Ray Cyrus"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Old Town Road</code>: 2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Lil Nas X"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Old Town Road</code>: 2}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Khalid"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>Beautiful People</code>: 1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"LadBaby"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">{<code>I Love Sausage Rolls</code>: 1}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Ed Sheeran had 3 number 1&#8217;s last year, giving him a total of 14 weeks at number 1.
I was surprised not to see what I thought was his most popular song of the year, South Of The Border.
Let&#8217;s see what happened there.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_did_south_of_the_border_do_on_the_charts">How did South Of The Border do on the charts?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (song:Song {title: "South Of The Border"})
MATCH (song)-[inChart:IN_CHART]-&gt;(chart)

WITH song, chart, inChart ORDER BY chart.start

RETURN inChart.position AS position,
       collect(toString(chart.end)) AS charts
ORDER BY position</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. How did South Of The Border do on the charts?</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">position</th>
<th class="tableblock halign-left valign-top">charts</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-10-31", "2019-11-14", "2019-11-21"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-11-07"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-10-24", "2019-11-28"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-12-05", "2019-12-12"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-12-19"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-10-17"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">40</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-10-10"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">55</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-12-26"]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Hmmm, it peaked at number 4 back in October and November, before falling down the chart after that.
I wonder if Ed Sheeran released any other songs last year?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_did_ed_sheerans_other_songs_do">How did Ed Sheeran&#8217;s other songs do?</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (artist:Artist {name: "Ed Sheeran"})
MATCH (artist)&lt;-[:ARTIST]-(song)-[inChart:IN_CHART]-&gt;(chart)

WITH song, artist,
     min(inChart.position) AS bestPosition,
     toString(min(chart.end)) AS chart
OPTIONAL MATCH (artist)&lt;-[:ARTIST]-(song)-[:ARTIST]-&gt;(collaborator)

RETURN song.title AS song,
       collect(collaborator.name) AS collaborators,
       bestPosition, chart
ORDER BY bestPosition</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. How did Ed Sheeran&#8217;s other songs do?</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">song</th>
<th class="tableblock halign-left valign-top">collaborators</th>
<th class="tableblock halign-left valign-top">bestPosition</th>
<th class="tableblock halign-left valign-top">chart</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"I Don&#8217;T Care"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Justin Bieber"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-05-23"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Take Me Back To London"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Stormzy"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-07-25"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Beautiful People"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Khalid"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-07-11"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Own It"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Burna Boy", "Stormzy"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-12-05"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"South Of The Border"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Camila Cabello", "Cardi B"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-10-10"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Cross Me"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Chance the Rapper", "PnB Rock"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-06-06"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Perfect"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-01-10"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Shape Of You"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-01-10"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The last two on this list are hangovers from 2018.
I expect they charted much higher during that year.</p>
</div>
<div class="paragraph">
<p>We can create a visual representation of this data by tweaking our query slightly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (artist:Artist {name: "Ed Sheeran"})
MATCH (artist)&lt;-[:ARTIST]-(song)-[inChart:IN_CHART]-&gt;(chart)

WITH song, artist,
     min(inChart.position) AS bestPosition,
     toString(min(chart.end)) AS chart

// Create virtual nodes and relationships to represent
// the best chart position for a song
CALL apoc.create.vNode(["Chart"], {end: chart}) YIELD node AS bestChart
CALL apoc.create.vRelationship(song, "IN_CHART", {position: bestPosition}, bestChart) YIELD rel

OPTIONAL MATCH (artist)&lt;-[:ARTIST]-(song)-[:ARTIST]-&gt;(collaborator)
RETURN *</code></pre>
</div>
</div>
<div class="paragraph">
<p>We could probably achieve the same result by tweaking the first part of the query, but I never like to miss an opportunity to use virtual nodes and relationships.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/ed-sheeran-songs.png" alt="ed sheeran songs">
</div>
<div class="title">Figure 6. Ed Sheeran songs in the UK Charts of 2019</div>
</div>
<div class="paragraph">
<p>It&#8217;s interesting that he&#8217;s had a collaborator on all his other songs in 2019, and all of his songs charted in the top 5.
Let&#8217;s explore artist collaborations a bit more.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_many_collaborators_did_artists_have_during_the_year">How many collaborators did artists have during the year?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following query computes the number of collaborators each artist had and then creates a histogram of those counts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (artist:Artist)
OPTIONAL MATCH (artist)&lt;-[:ARTIST]-(song)-[:ARTIST]-&gt;(otherArtist)
WITH artist, count(otherArtist) AS count
RETURN count, count(*)
ORDER BY count</code></pre>
</div>
</div>
<div class="paragraph">
<p>This data is easiest to interpret as a chart, which we can create using <a href="https://www.chartgo.com/" target="_blank" rel="noopener">chartgo.com</a>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/collaborations-count.png" alt="collaborations count">
</div>
<div class="title">Figure 7. Artist Collaborations</div>
</div>
<div class="paragraph">
<p>Although the majority of artists mostly worked alone or had only one collaborator, there are a reasonable number who had 6 or more collaborators over the year.</p>
</div>
<div class="paragraph">
<p>In all the queries that we&#8217;re written so far, we&#8217;ve been looking at the chart position for a song in a single week.
We haven&#8217;t written any queries that look at how a song&#8217;s chart position changes over the weeks.
What if we want to do this?</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_which_song_had_the_biggest_climb_between_weeks">Which song had the biggest climb between weeks?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;re going to work out which song had the biggest climb between weeks, but first we&#8217;ll create relationships between consecutive charts to make it easier to write this query.
So for example we&#8217;ll create a <code>NEXT</code> relationship between:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>Chart</em> nodes with <em>end</em> properties <code>2019-02-14</code> and <code>2019-02-21</code></p>
</li>
<li>
<p>The <em>Chart</em> nodes with <em>end</em> properties <code>2019-02-21</code> and <code>2019-02-28</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And so on.</p>
</div>
<div class="paragraph">
<p>The following query collects all the <em>Chart</em> nodes in order by date and then creates <code>NEXT</code> relationships between consecutive nodes using the <code>apoc.nodes.link</code> procedure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (chart:Chart)
WITH chart ORDER BY chart.start
WITH collect(chart) AS charts
CALL apoc.nodes.link(charts, "NEXT")
RETURN count(*)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Neo4j Browser visualisation below shows the linked list that we&#8217;ve now created:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://markhneedham.com/blog/
/uploads/2020/01/charts-linked-list.png" alt="charts linked list">
</div>
<div class="title">Figure 8. Linked list of consecutive Chart nodes</div>
</div>
<div class="paragraph">
<p>We can now write the following query to return the 5 songs that made the biggest climb in the charts in consecutive weeks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">MATCH (song:Song)-[inChart:IN_CHART]-&gt;(chart)&lt;-[:NEXT]-(previousChart),
      (previousChart)&lt;-[inChartPrevious:IN_CHART]-(song),
      (song)-[:ARTIST]-&gt;(artist)
WITH song, collect(artist.name) AS artists,
     inChartPrevious.position AS firstPosition,
     inChart.position AS secondPosition,
     previousChart, chart
RETURN song.title AS song, artists, firstPosition, secondPosition,
       firstPosition - secondPosition AS change,
       toString(previousChart.end) AS firstChart,
       toString(chart.end) AS secondChart
ORDER BY change DESC
LIMIT 5</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Which song had the biggest climb between weeks?</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">song</th>
<th class="tableblock halign-left valign-top">artists</th>
<th class="tableblock halign-left valign-top">firstPosition</th>
<th class="tableblock halign-left valign-top">secondPosition</th>
<th class="tableblock halign-left valign-top">change</th>
<th class="tableblock halign-left valign-top">firstChart</th>
<th class="tableblock halign-left valign-top">secondChart</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Bruises"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Lewis Capaldi"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">71</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-10-03"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-10-10"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Playing Games"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Summer Walker", "Bryson Tiller"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">93</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">68</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-10-10"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-10-17"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Girls Like You"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Maroon 5", "Cardi B"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">97</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">34</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">63</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-01-03"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-01-10"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Lose You To Love Me"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Selena Gomez"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">62</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-10-31"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-11-07"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Play"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Years &amp; Years", "Jax Jones"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-01-03"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-01-10"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>There are some big climbers there, but I think it&#8217;ll be more interesting to look at number 1 songs in this context.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_which_songs_went_straight_in_at_number_1">Which songs went straight in at number 1?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start by seeing whether any of our number 1 songs went straight in at number 1.
The following query will tell us the answer to this question:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">// Find songs that charted at position 1
MATCH (song:Song)-[inChart:IN_CHART {position: 1}]-&gt;(chart)

// And didn't have an entry on a chart before this one
WHERE not((chart)&lt;-[:NEXT*]-()&lt;-[:IN_CHART]-(song))

WITH song, chart ORDER BY chart.end
RETURN song.title AS song,
       [(song)-[:ARTIST]-&gt;(artist) | artist.name] AS artists,
       collect(toString(chart.end)) AS chart</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Which songs went straight in at number 1?</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">song</th>
<th class="tableblock halign-left valign-top">artists</th>
<th class="tableblock halign-left valign-top">chart</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Sweet But Psycho"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ava Max"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-01-03"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"7 Rings"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ariana Grande"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-01-31"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Break Up With Your Girlfriend I&#8217;M Bored"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ariana Grande"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-02-21"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Vossi Bop"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Stormzy"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-05-09"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"I Don&#8217;T Care"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ed Sheeran", "Justin Bieber"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-05-23"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"I Love Sausage Rolls"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["LadBaby"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["2019-12-26"]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>6 songs went straight in at the top.
That means we still have 6 songs that came in at a lower position and then climbed to number 1.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_which_songs_didnt_go_straight_to_number_1">Which songs didn&#8217;t go straight to number 1?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following query will help us figure out what position they charted on their first entry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-cypher" data-lang="cypher">// Find the first week that the song got to number 1
MATCH (song:Song)-[inChart:IN_CHART {position: 1}]-&gt;(chart)
WITH song, chart ORDER BY song, chart.end
WITH song, collect(chart)[0] AS firstWeekAtNumber1

// Find the earliest week that the song charted
MATCH (firstWeekAtNumber1)&lt;-[:NEXT*]-(previous)&lt;-[previousInChart:IN_CHART]-(song)
WITH song, firstWeekAtNumber1, previous, previousInChart
ORDER BY song, previous.end
WITH song, firstWeekAtNumber1,
     collect(previousInChart.position)[0] AS firstPosition,
     collect(previous)[0] AS firstWeek

RETURN song.title AS song,
       [(song)-[:ARTIST]-&gt;(artist) | artist.name] AS artists,
       toString(firstWeekAtNumber1.end) AS firstWeekAtNumber1,
       firstPosition AS firstPosition,
       toString(firstWeek.end) AS firstWeek,
       [path = (firstWeekAtNumber1)&lt;-[:NEXT*]-(firstWeek) | length(path)][0] AS weeksToReachNumber1</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Which songs didn&#8217;t go straight to number 1?</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">song</th>
<th class="tableblock halign-left valign-top">artists</th>
<th class="tableblock halign-left valign-top">firstWeekAtNumber1</th>
<th class="tableblock halign-left valign-top">firstPosition</th>
<th class="tableblock halign-left valign-top">firstWeek</th>
<th class="tableblock halign-left valign-top">weeksToReachNumber1</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Someone You Loved"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Lewis Capaldi"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-03-07"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">66</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-01-17"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Dance Monkey"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Tones and I"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-10-10"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-08-15"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Take Me Back To London"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Ed Sheeran", "Stormzy"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-09-05"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-07-25"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Senorita"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Shawn Mendes", "Camila Cabello"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-07-18"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-07-04"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Beautiful People"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Khalid", "Ed Sheeran"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-07-25"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-07-11"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Old Town Road"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">["Billy Ray Cyrus", "Lil Nas X"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-04-25"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2019-04-04"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Interestingly the longest running number 1, Dance Monkey, started at the lowest position.
And not only that, it took almost 2 months for it to get up to the number 1 spot.
So if you start with a low chart position, all is not lost!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_whats_interesting_about_this_quickgraph">Whats interesting about this QuickGraph?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This post has gone on for much longer than I intended, but I&#8217;ll conclude with some thoughts on what makes this QuickGraph interesting.</p>
</div>
<div class="paragraph">
<p>There&#8217;s a lot of analysis of the charts in the UK, but it&#8217;s often done along one dimension, be that a song or an artist.
By modelling the data as a graph we can easily query the data along multiple dimensions.
I especially enjoyed writing the queries that looked at how songs did across multiple charts.</p>
</div>
<div class="paragraph">
<p>We could certainly extend our analysis further by adding in Wiki data, as Jess Barrasa did in his <a href="https://jbarrasa.com/2019/12/05/quickgraph10-enrich-your-neo4j-knowledge-graph-by-querying-wikidata/" target="_blank" rel="noopener">QuickGraph #10</a>, but that can wait for another blog post!</p>
</div>
</div>
</div>

    <div id="social-bar">
	<ul class="rrssb-buttons clearfix">
      <li class="email">
          <a href="mailto:?subject=QuickGraph%20%234%3a%20UK%20Official%20Singles%20Chart%202019&amp;body=https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path transform="scale(0.014,-0.014) translate(0,-1670)" d="M1792 826v-794q0 -66 -47 -113t-113 -47h-1472q-66 0 -113 47t-47 113v794q44 -49 101 -87q362 -246 497 -345q57 -42 92.5 -65.5t94.5 -48t110 -24.5h1h1q51 0 110 24.5t94.5 48t92.5 65.5q170 123 498 345q57 39 100 87zM1792 1120q0 -79 -49 -151t-122 -123 q-376 -261 -468 -325q-10 -7 -42.5 -30.5t-54 -38t-52 -32.5t-57.5 -27t-50 -9h-1h-1q-23 0 -50 9t-57.5 27t-52 32.5t-54 38t-42.5 30.5q-91 64 -262 182.5t-205 142.5q-62 42 -117 115.5t-55 136.5q0 78 41.5 130t118.5 52h1472q65 0 112.5 -47t47.5 -113z"/>
                  </svg>
              </span>
              <span class="text">Email</span>
          </a>
      </li>
      <li class="facebook">
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434 c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726 c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"/>
                  </svg>
              </span>
              <span class="text">Facebook</span>
          </a>
      </li>
			<li class="twitter">
          <a href="http://twitter.com/home?status=QuickGraph%20%234%3a%20UK%20Official%20Singles%20Chart%202019%20https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
		                  <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32 c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155 C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965 C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683 c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851 C26.275,7.229,25.39,8.196,24.253,8.756z"/>
                  </svg>
              </span>
              <span class="text">Twitter</span>
          </a>
      </li>
			<li class="linkedin">
          <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/&amp;title=QuickGraph%20%234%3a%20UK%20Official%20Singles%20Chart%202019&amp;summary=For%20our%20first%20QuickGraph%20of%20the%20new%20decade%20we%26%238217%3bre%20going%20to%20explore%20data%20from%20the%20Official%20UK%20Top%2040%20Chart.%20This%20chart%20ranks%20the%20top%20100%20songs%20of%20the%20week%20based%20on%20official%20sales%20of%20sales%20of%20downloads%2c%20CD%2c%20vinyl%2c%20audio%20streams%20and%20video%20streams.%20Every%20week%20BBC%20Radio%201%20broadcast%20the%20top%2040%20songs%2c%20which%20explains%20the%20name%20of%20the%20chart.%0a%20%20Figure%201.%20The%20Official%20UK%20Charts%20%20Scraping%20the%20Official%20Charts%20I%20couldn%26%238217%3bt%20find%20a%20dump%20of%20the%20dataset%2c%20so%20we%26%238217%3bre%20going%20to%20use%20our%20web%20scraping%20skills%20again...." class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803 c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048 h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501 c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546 C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"/>
                  </svg>
              </span>
              <span class="text">LinkedIn</span>
          </a>
      </li>
      <li class="tumblr">
					<script>
						document.write('<a href="http://www.tumblr.com/share?v=3&amp;u=' + encodeURIComponent('https:\/\/markhneedham.com\/blog\/2020\/01\/04\/quick-graph-uk-official-charts\/') + '&amp;t=QuickGraph #4: UK Official Singles Chart 2019" class="popup">');
					</script>
              <span class="icon">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
											<path d="M18.02 21.842c-2.029 0.052-2.422-1.396-2.439-2.446v-7.294h4.729V7.874h-4.71V1.592c0 0-3.653 0-3.714 0 s-0.167 0.053-0.182 0.186c-0.218 1.935-1.144 5.33-4.988 6.688v3.637h2.927v7.677c0 2.8 1.7 6.7 7.3 6.6 c1.863-0.03 3.934-0.795 4.392-1.453l-1.22-3.539C19.595 21.6 18.7 21.8 18 21.842z"/>
									</svg>
              </span>
              <span class="text">Tumblr</span>
          <script>document.write('</a>');</script>
      </li>
      <li class="reddit">
          <a href="http://www.reddit.com/submit?url=https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/">
              <span class="icon">
                  <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
											<g>
													<path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"/>
													<path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"/>
													<path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 19.5 17.8 19.5 17.5 19.791z"/>
													<path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 C26.354 13.8 26.1 14.3 25.8 14.605z"/>
											</g>
									</svg>
              </span>
              <span class="text">Reddit</span>
          </a>
      </li>
      <li class="googleplus">
          <a href="https://plus.google.com/share?url=https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/" class="popup">
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                      <g>
                          <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663 c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027 C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068 c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562 c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41 c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511 c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478 c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492 c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479 c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"/>
                          <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004 23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89"/>
                      </g>
                  </svg>
              </span>
              <span class="text">Google+</span>
          </a>
      </li>
      <li class="pinterest">
          <script>
						var imgurl = "https:\/\/markhneedham.com\/blog\/logo.png";
						var firstimg = document.getElementsByClassName("2020")[0].getElementsByTagName("img")[0];
						if (firstimg !== undefined) {
							imgurl = firstimg.src;
						}
						document.write('<a href="http://pinterest.com/pin/create/button/?url=https:\/\/markhneedham.com\/blog\/2020\/01\/04\/quick-graph-uk-official-charts\/&amp;media=' + imgurl + '&amp;description=QuickGraph #4: UK Official Singles Chart 2019" class="popup">');
					</script>
              <span class="icon">
                  <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
		                  <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785 C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458 c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557 c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168 C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239 c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"/>
                  </svg>
              </span>
              <span class="text">Pinterest</span>
          <script>document.write('</a>');</script>
      </li>
      <li class="pocket">
          <a href="https://getpocket.com/save?url=https://markhneedham.com/blog/2020/01/04/quick-graph-uk-official-charts/"  class="popup">
              <span class="icon">
                  <svg width="32px" height="28px" viewBox="0 0 32 28" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                      <path d="M28.7817528,0.00172488695 C30.8117487,0.00431221738 31.9749312,1.12074529 31.9644402,3.10781507 C31.942147,6.67703739 32.1336065,10.2669583 31.8057648,13.8090137 C30.7147076,25.5813672 17.2181194,31.8996281 7.20714461,25.3808491 C2.71833574,22.4571656 0.196577202,18.3122624 0.0549495772,12.9357897 C-0.0342233715,9.5774348 0.00642900214,6.21519891 0.0300336062,2.85555035 C0.0405245414,1.1129833 1.21157517,0.0146615391 3.01995012,0.00819321302 C7.34746087,-0.00603710433 11.6775944,0.00431221738 16.0064164,0.00172488695 C20.2644248,0.00172488695 24.5237444,-0.00215610869 28.7817528,0.00172488695 L28.7817528,0.00172488695 Z M8.64885184,7.85611511 C7.38773662,7.99113854 6.66148108,8.42606978 6.29310958,9.33228474 C5.90114134,10.2969233 6.17774769,11.1421181 6.89875951,11.8276216 C9.35282156,14.161969 11.8108164,16.4924215 14.2976518,18.7943114 C15.3844131,19.7966007 16.5354102,19.7836177 17.6116843,18.7813283 C20.0185529,16.5495467 22.4070683,14.2982907 24.7824746,12.0327533 C25.9845979,10.8850542 26.1012707,9.56468083 25.1469132,8.60653379 C24.1361858,7.59255976 22.8449191,7.6743528 21.5890476,8.85191291 C19.9936451,10.3488554 18.3680912,11.8172352 16.8395462,13.3777945 C16.1342655,14.093159 15.7200114,14.0048744 15.0566806,13.3440386 C13.4599671,11.7484252 11.8081945,10.2060421 10.1262706,8.70001155 C9.65564653,8.27936164 9.00411403,8.05345704 8.64885184,7.85611511 L8.64885184,7.85611511 L8.64885184,7.85611511 Z"></path>
                  </svg>
              </span>
              <span class="text">Pocket</span>
          </a>
      </li>
  </ul>
</div>

    <div itemprop="author" itemscope itemtype="http://schema.org/Person">
  <h5>About the author</h5>
  <section>
    <p><a href="https://twitter.com/markhneedham" itemprop="name" rel="author">I'm</a> a Developer Relations Engineer for <a href="https://neo4j.com/developer/">Neo4j</a>, the world's leading graph database.</p>
  </section>
</div>

    <div id="comments">
    
    
    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'markhneedham';
      var disqus_identifier = 'https:\/\/markhneedham.com\/blog\/2020\/01\/04\/quick-graph-uk-official-charts\/';
      var disqus_title = 'QuickGraph #4: UK Official Singles Chart 2019';
      var disqus_url = 'https:\/\/markhneedham.com\/blog\/2020\/01\/04\/quick-graph-uk-official-charts\/';
      (function() {
        if (window.location.hostname == "localhost")
                return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
    
</div>

</article>

</main>

  <footer id="footer">
			<section id="footer-message">&copy; Mark Needham. All rights reserved. Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>. <a href="https://github.com/kathyqian/crisp-ghost-theme" target="_blank">Crisp</a> theme by <a href="http://kathyqian.com" target="_blank">Kathy Qian</a>.</section>
		</footer>

    <script>
      (function(c,f){asyncLoader=function(i,h){i.foreach(function(k,j){e(j,d(j),h)});if(typeof h.callback=="function"){var g=setInterval(function(){if(f.readyState==="complete"){clearInterval(g);h.callback()}},10)}};var d=function(g){var h=g.split(".");return h[h.length-1]},e=function(h,i,g){switch(i){case"js":a(h,g);break;case"css":b(h);break;default:break}},a=function(i,h){var g=document.createElement("script");g.type="text/javascript";g.async=true;g.src=i;document.getElementsByTagName("head")[0].appendChild(g)},b=function(g){var h=document.createElement("link");h.type="text/css";h.rel="stylesheet";h.href=g;document.getElementsByTagName("head")[0].appendChild(h)};Array.prototype.foreach=function(h){for(var g=0;g<this.length;g++){h(g,this[g])}}})(this,document);

      var WebFontConfig={google:{families:["Open Sans:300italic,700italic,300,700","Bree+Serif"]}};
      asyncLoader([
        "//netdna.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.css",
        "//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js",
        "//cdnjs.cloudflare.com/ajax/libs/webfont/1.5.16/webfontloader.js"
      ],{
        callback:function(){
          asyncLoader([
            "https:\/\/markhneedham.com\/blog\/css/rrssb.css",
            "https:\/\/markhneedham.com\/blog\/js/gist.min.js",
            "https:\/\/markhneedham.com\/blog\/js/rrssb.min.js",
            "//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css"
          ], { callback:function() {
              hljs.initHighlighting();
          }});
        }
      });
    </script>
	
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-9991626-1"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'UA-9991626-1');
    </script>

    <script type="text/javascript" src="https://markhneedham.com/blog/js/neo4j-cm.js" ></script>
    <script type="text/javascript" src="https://markhneedham.com/blog/js/neo_codemirror.js" ></script>

    <link rel="stylesheet" href="https://markhneedham.com/blog/css/codemirror.css" />

    <script type="text/javascript">
        window.onload = function () {
            CodeMirror.colorize();
        }
    </script>


  
	</body>
</html>

